{% extends 'admin/dashboard.html.twig' %}

{% block title %}Statistiques Produits{% endblock %}

{% block admin_content %}

{# â”€â”€ Page Header â”€â”€ #}
<div class="page-header">
    <h1 class="page-title">ðŸ“Š Statistiques Produits</h1>
    <p class="page-subtitle">Vue d'ensemble de ton e-commerce</p>
</div>

{# â”€â”€ Stat Cards â”€â”€ #}
<div class="row g-4 mb-4">
    <div class="col-md-3">
        <div class="card">
            <div class="stat-card">
                <div class="number">{{ total_orders }}</div>
                <div class="label"><i class="fas fa-shopping-bag me-1"></i> Commandes</div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card">
            <div class="stat-card">
                <div class="number">{{ total_revenue }} TND</div>
                <div class="label"><i class="fas fa-coins me-1"></i> Revenus</div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card">
            <div class="stat-card">
                <div class="number">{{ total_products }}</div>
                <div class="label"><i class="fas fa-box me-1"></i> Produits</div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card">
            <div class="stat-card">
                <div class="number">{{ total_users }}</div>
                <div class="label"><i class="fas fa-users me-1"></i> Utilisateurs</div>
            </div>
        </div>
    </div>
</div>

{# â”€â”€ Charts â”€â”€ #}
<div class="row g-4">
    <div class="col-lg-7">
        <div class="card">
            <div class="card-header d-flex align-items-center gap-2">
                <i class="fas fa-chart-line" style="color:#6366f1"></i>
                Ventes par mois
            </div>
            <div class="card-body">
                <canvas id="chartVentes" style="min-height:320px;"></canvas>
            </div>
        </div>
    </div>
    <div class="col-lg-5">
        <div class="card">
            <div class="card-header d-flex align-items-center gap-2">
                <i class="fas fa-trophy" style="color:#10b981"></i>
                Top 5 Produits
            </div>
            <div class="card-body">
                <canvas id="chartProduits" style="min-height:320px;"></canvas>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block javascripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script>
    // â”€â”€ Ventes par mois â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    new Chart(document.getElementById('chartVentes'), {
        type: 'line',
        data: {
            labels: {{ months|raw }},
            datasets: [{
                label: 'Ventes (TND)',
                data: {{ revenues|raw }},
                borderColor: '#6366f1',
                backgroundColor: 'rgba(99,102,241,0.1)',
                borderWidth: 3,
                tension: 0.4,
                fill: true,
                pointBackgroundColor: '#818cf8'
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { labels: { color: '#94a3b8' } }
            },
            scales: {
                x: {
                    ticks: { color: '#94a3b8' },
                    grid:  { color: 'rgba(148,163,184,0.1)' }
                },
                y: {
                    ticks: { color: '#94a3b8' },
                    grid:  { color: 'rgba(148,163,184,0.1)' }
                }
            }
        }
    });

    // â”€â”€ Top 5 produits â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    new Chart(document.getElementById('chartProduits'), {
        type: 'bar',
        data: {
            labels: {{ productNames|raw }},
            datasets: [{
                label: 'QuantitÃ© vendue',
                data: {{ productQtys|raw }},
                backgroundColor: [
                    'rgba(16,185,129,0.8)',
                    'rgba(99,102,241,0.8)',
                    'rgba(245,158,11,0.8)',
                    'rgba(239,68,68,0.8)',
                    'rgba(139,92,246,0.8)'
                ],
                borderRadius: 6
            }]
        },
        options: {
            responsive: true,
            indexAxis: 'y',
            plugins: {
                legend: { labels: { color: '#94a3b8' } }
            },
            scales: {
                x: {
                    ticks: { color: '#94a3b8' },
                    grid:  { color: 'rgba(148,163,184,0.1)' }
                },
                y: {
                    ticks: { color: '#94a3b8' },
                    grid:  { color: 'rgba(148,163,184,0.1)' }
                }
            }
        }
    });
</script>
{% endblock %}